[
    {
        "client_msg_id": "d60ca57a-b3ee-488a-957e-86e84086a131",
        "type": "message",
        "text": "<@UPSPAP97D> ありがとうございます。今、チャンネル作ります",
        "user": "UPSPAMY7M",
        "ts": "1583998131.005600",
        "team": "TKS1Q2JUE",
        "user_team": "TKS1Q2JUE",
        "source_team": "TKS1Q2JUE",
        "user_profile": {
            "avatar_hash": "b3edf66a5d2f",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-11-05\/810115393635_b3edf66a5d2f9b4ceae4_72.jpg",
            "first_name": "畠　圭佑",
            "real_name": "畠　圭佑",
            "display_name": "hata",
            "team": "TKS1Q2JUE",
            "name": "hata",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "g4b",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "user",
                                "user_id": "UPSPAP97D"
                            },
                            {
                                "type": "text",
                                "text": " ありがとうございます。今、チャンネル作ります"
                            }
                        ]
                    }
                ]
            }
        ],
        "thread_ts": "1583998131.005600",
        "reply_count": 1,
        "reply_users_count": 1,
        "latest_reply": "1583998228.006600",
        "reply_users": [
            "UPSPAP97D"
        ],
        "replies": [
            {
                "user": "UPSPAP97D",
                "ts": "1583998228.006600"
            }
        ],
        "is_locked": false,
        "subscribed": false
    },
    {
        "client_msg_id": "14E99DD9-2A1D-4975-B28F-D60E302876F3",
        "type": "message",
        "text": "ありがとうございます。お手数かけます。\nそれと、紛らわしくなるので、このチャンネルでアップしたシェアカーのメッセージは削除しておきます。",
        "user": "UPSPAP97D",
        "ts": "1583998228.006600",
        "team": "TKS1Q2JUE",
        "user_team": "TKS1Q2JUE",
        "source_team": "TKS1Q2JUE",
        "user_profile": {
            "avatar_hash": "b09c08e50940",
            "image_72": "https:\/\/avatars.slack-edge.com\/2019-11-15\/837678602742_b09c08e50940786c015b_72.png",
            "first_name": "村上",
            "real_name": "村上 弥夢",
            "display_name": "hiromu",
            "team": "TKS1Q2JUE",
            "name": "s1260166",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "edited": {
            "user": "UPSPAP97D",
            "ts": "1583998927.000000"
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "s\/Reh",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "ありがとうございます。お手数かけます。\nそれと、紛らわしくなるので、このチャンネルでアップしたシェアカーのメッセージは削除しておきます。"
                            }
                        ]
                    }
                ]
            }
        ],
        "thread_ts": "1583998131.005600",
        "parent_user_id": "UPSPAMY7M"
    },
    {
        "client_msg_id": "891e4aa3-42d3-4da1-b6a3-3725b5db7fbd",
        "type": "message",
        "text": "```#xlsxfile to csvfile but xlsxfile have password, so need to solve this password.\n#only this code, all file cannot change to csv, these datas change to csv using excel.\n\nimport glob\nimport pandas as pd\nimport tempfile\nimport msoffcrypto\nfrom pathlib import Path\n\nfile_dir = Path(r'IDPOS\/')\npassword = 'hogehoge'\nsheet_name = ''\"\n\ncount = 0\nfor file in file_dir.glob(\"*.xlsx\"):\n    print(count)\n    print(file)\n    count = count + 1\n    with file.open(\"rb\") as f,tempfile.TemporaryFile() as tf:\n        office_file = msoffcrypto.OfficeFile(f)\n        office_file.load_key(password=\"7ce2019\")\n        office_file.decrypt(tf)\n        df = pd.read_excel(tf)\n    filename = str(file)[6:99]\n    filename = filename.replace(\".xlsx\", \".csv\")\n    df.to_csv('changenew\/' + filename,index=False)```",
        "user": "UKH07E67M",
        "ts": "1584024703.007200",
        "team": "TKS1Q2JUE",
        "user_team": "TKS1Q2JUE",
        "source_team": "TKS1Q2JUE",
        "user_profile": {
            "avatar_hash": "42b0524c15ef",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-12-22\/1589400144565_42b0524c15efa13345bf_72.png",
            "first_name": "Aoshi",
            "real_name": "Aoshi Suzuki",
            "display_name": "aoshi",
            "team": "TKS1Q2JUE",
            "name": "s1260241",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "edited": {
            "user": "UKH07E67M",
            "ts": "1584024851.000000"
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "=EZno",
                "elements": [
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "#xlsxfile to csvfile but xlsxfile have password, so need to solve this password.\n#only this code, all file cannot change to csv, these datas change to csv using excel.\n\nimport glob\nimport pandas as pd\nimport tempfile\nimport msoffcrypto\nfrom pathlib import Path\n\nfile_dir = Path(r'IDPOS\/')\npassword = 'hogehoge'\nsheet_name = ''\"\n\ncount = 0\nfor file in file_dir.glob(\"*.xlsx\"):\n    print(count)\n    print(file)\n    count = count + 1\n    with file.open(\"rb\") as f,tempfile.TemporaryFile() as tf:\n        office_file = msoffcrypto.OfficeFile(f)\n        office_file.load_key(password=\"7ce2019\")\n        office_file.decrypt(tf)\n        df = pd.read_excel(tf)\n    filename = str(file)[6:99]\n    filename = filename.replace(\".xlsx\", \".csv\")\n    df.to_csv('changenew\/' + filename,index=False)"
                            }
                        ]
                    }
                ]
            }
        ],
        "thread_ts": "1583976669.003400",
        "parent_user_id": "UPSPAMY7M"
    },
    {
        "client_msg_id": "c921af8d-e3f0-4a43-a3f4-b05de91c0b0d",
        "type": "message",
        "text": "```#make csv first\n\nimport pandas as pd\nfrom pathlib import Path\nimport glob\n\ndef BlockOfDatatoRead(dirname):\n    filedir = Path(r'IDPOS\/changenew\/' + str(dirname) + r\"\/\")\n    count = 0\n    matdata = []\n    for file in sorted(filedir.glob(\"*.csv\")):\n        print(count)\n        print(file)\n        matdata.append(pd.read_csv(file))\n        count = count + 1\n    return matdata\n\nikki = BlockOfDatatoRead(\"ikki\")\nhanaharu = BlockOfDatatoRead(\"hanaharu\")\nmachikita = BlockOfDatatoRead(\"machikita\")\nmonden = BlockOfDatatoRead(\"monden\")\n\ndef Make_csv(data,directly):\n    count = 0\n    for i in range(len(data)):\n        print(count)\n        data[i].to_csv(r\"IDPOS\/changenew\/after_change\/\" + directly + r\"\/\" + directly + str(i) + r\".csv\")\n        count = count + 1\n\nMake_csv(ikki,\"ikki\")\nMake_csv(hanaharu,\"hanaharu\")\nMake_csv(machikita,\"machikita\")\nMake_csv(monden,\"monden\")```",
        "user": "UKH07E67M",
        "ts": "1584024766.007400",
        "team": "TKS1Q2JUE",
        "user_team": "TKS1Q2JUE",
        "source_team": "TKS1Q2JUE",
        "user_profile": {
            "avatar_hash": "42b0524c15ef",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-12-22\/1589400144565_42b0524c15efa13345bf_72.png",
            "first_name": "Aoshi",
            "real_name": "Aoshi Suzuki",
            "display_name": "aoshi",
            "team": "TKS1Q2JUE",
            "name": "s1260241",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "edited": {
            "user": "UKH07E67M",
            "ts": "1584024873.000000"
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "LQ8g",
                "elements": [
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "#make csv first\n\nimport pandas as pd\nfrom pathlib import Path\nimport glob\n\ndef BlockOfDatatoRead(dirname):\n    filedir = Path(r'IDPOS\/changenew\/' + str(dirname) + r\"\/\")\n    count = 0\n    matdata = []\n    for file in sorted(filedir.glob(\"*.csv\")):\n        print(count)\n        print(file)\n        matdata.append(pd.read_csv(file))\n        count = count + 1\n    return matdata\n\nikki = BlockOfDatatoRead(\"ikki\")\nhanaharu = BlockOfDatatoRead(\"hanaharu\")\nmachikita = BlockOfDatatoRead(\"machikita\")\nmonden = BlockOfDatatoRead(\"monden\")\n\ndef Make_csv(data,directly):\n    count = 0\n    for i in range(len(data)):\n        print(count)\n        data[i].to_csv(r\"IDPOS\/changenew\/after_change\/\" + directly + r\"\/\" + directly + str(i) + r\".csv\")\n        count = count + 1\n\nMake_csv(ikki,\"ikki\")\nMake_csv(hanaharu,\"hanaharu\")\nMake_csv(machikita,\"machikita\")\nMake_csv(monden,\"monden\")"
                            }
                        ]
                    }
                ]
            }
        ],
        "thread_ts": "1583976669.003400",
        "parent_user_id": "UPSPAMY7M"
    },
    {
        "client_msg_id": "574f003a-0d98-4817-8617-93f7b087de3c",
        "type": "message",
        "text": "```# check one person\n\nimport pandas as pd\nfrom pathlib import Path\nimport glob\n\ndef NewDataRead(dirname):\n    filedir = Path(r'IDPOS\/changenew\/after_change\/' + str(dirname) + r\"\/\")\n    count = 0\n    matdata = []\n    for file in sorted(filedir.glob(\"*.csv\")):\n        print(count)\n        print(file)\n        matdata.append(pd.read_csv(file,index_col = 0))\n        count = count + 1\n    return matdata\n\nikki = NewDataRead(\"ikki\")\nhanaharu = NewDataRead(\"hanaharu\")\nmachikita = NewDataRead(\"machikita\")\nmonden = NewDataRead(\"monden\")\n\n#一人のデータを抽出\ndef OnePersonCheck(intID,data):\n    count = 0\n    for i in range(len(data)):\n        if count == 0 and len(data[i][data[i].YB連携ID == intID]) != 0:\n            matdata = data[i][data[i].YB連携ID == intID]\n            count = 1\n            print(i)\n        elif count == 1 and len(data[i][data[i].YB連携ID == intID]) != 0:\n            matdata = matdata.append(data[i][data[i].YB連携ID == intID])[matdata.columns.tolist()]\n            #後ろの[matdata.columns.tolist()]をつけないと列の順序が変化して変なカラムが追加されて死ぬ。\n            print(i)\n    return matdata\n\nuser29ikki = OnePersonCheck(29,ikki)```",
        "user": "UKH07E67M",
        "ts": "1584024810.007600",
        "team": "TKS1Q2JUE",
        "user_team": "TKS1Q2JUE",
        "source_team": "TKS1Q2JUE",
        "user_profile": {
            "avatar_hash": "42b0524c15ef",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-12-22\/1589400144565_42b0524c15efa13345bf_72.png",
            "first_name": "Aoshi",
            "real_name": "Aoshi Suzuki",
            "display_name": "aoshi",
            "team": "TKS1Q2JUE",
            "name": "s1260241",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "edited": {
            "user": "UKH07E67M",
            "ts": "1584024888.000000"
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "PlU",
                "elements": [
                    {
                        "type": "rich_text_preformatted",
                        "elements": [
                            {
                                "type": "text",
                                "text": "# check one person\n\nimport pandas as pd\nfrom pathlib import Path\nimport glob\n\ndef NewDataRead(dirname):\n    filedir = Path(r'IDPOS\/changenew\/after_change\/' + str(dirname) + r\"\/\")\n    count = 0\n    matdata = []\n    for file in sorted(filedir.glob(\"*.csv\")):\n        print(count)\n        print(file)\n        matdata.append(pd.read_csv(file,index_col = 0))\n        count = count + 1\n    return matdata\n\nikki = NewDataRead(\"ikki\")\nhanaharu = NewDataRead(\"hanaharu\")\nmachikita = NewDataRead(\"machikita\")\nmonden = NewDataRead(\"monden\")\n\n#一人のデータを抽出\ndef OnePersonCheck(intID,data):\n    count = 0\n    for i in range(len(data)):\n        if count == 0 and len(data[i][data[i].YB連携ID == intID]) != 0:\n            matdata = data[i][data[i].YB連携ID == intID]\n            count = 1\n            print(i)\n        elif count == 1 and len(data[i][data[i].YB連携ID == intID]) != 0:\n            matdata = matdata.append(data[i][data[i].YB連携ID == intID])[matdata.columns.tolist()]\n            #後ろの[matdata.columns.tolist()]をつけないと列の順序が変化して変なカラムが追加されて死ぬ。\n            print(i)\n    return matdata\n\nuser29ikki = OnePersonCheck(29,ikki)"
                            }
                        ]
                    }
                ]
            }
        ],
        "thread_ts": "1583976669.003400",
        "parent_user_id": "UPSPAMY7M"
    },
    {
        "client_msg_id": "225575b6-1562-4ca6-a880-59a20d362a4b",
        "type": "message",
        "text": "遅くなってしまい大変申し訳ありませんでした。",
        "user": "UKH07E67M",
        "ts": "1584024822.007800",
        "team": "TKS1Q2JUE",
        "user_team": "TKS1Q2JUE",
        "source_team": "TKS1Q2JUE",
        "user_profile": {
            "avatar_hash": "42b0524c15ef",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-12-22\/1589400144565_42b0524c15efa13345bf_72.png",
            "first_name": "Aoshi",
            "real_name": "Aoshi Suzuki",
            "display_name": "aoshi",
            "team": "TKS1Q2JUE",
            "name": "s1260241",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "GAiH",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "遅くなってしまい大変申し訳ありませんでした。"
                            }
                        ]
                    }
                ]
            }
        ],
        "thread_ts": "1583976669.003400",
        "parent_user_id": "UPSPAMY7M"
    },
    {
        "client_msg_id": "fdaca674-d5de-4284-9ad7-78dc68268709",
        "type": "message",
        "text": "次の目的はロイヤルカスタマー分析をやってみることです",
        "user": "UKH07E67M",
        "ts": "1584024937.008300",
        "team": "TKS1Q2JUE",
        "user_team": "TKS1Q2JUE",
        "source_team": "TKS1Q2JUE",
        "user_profile": {
            "avatar_hash": "42b0524c15ef",
            "image_72": "https:\/\/avatars.slack-edge.com\/2020-12-22\/1589400144565_42b0524c15efa13345bf_72.png",
            "first_name": "Aoshi",
            "real_name": "Aoshi Suzuki",
            "display_name": "aoshi",
            "team": "TKS1Q2JUE",
            "name": "s1260241",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "s9V",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "次の目的はロイヤルカスタマー分析をやってみることです"
                            }
                        ]
                    }
                ]
            }
        ],
        "thread_ts": "1583976669.003400",
        "parent_user_id": "UPSPAMY7M"
    }
]